{% extends "questions/base.html" %}

{% block title %}<title>{{ question.title }}</title>{% endblock %}

{% block content %}

<div class="col-md-8 px-0">

  <div class="card block question">
    <div class="row">
      <div class="d-flex flex-column mx-auto">
        {% comment %} {% load media %} {% endcomment %}
        <img src="{{ MEDIA_URL }}{{ question.author.avatar.url }}" width="80" height="80" class="rounded-circle mb-3">
      </div>
      <div class="col-md-10 order-2 pl-0">
        <h5 class="pb-3 mb-3 border-bottom"><a>{{ question.title }}</a></h5>
        <p class="card-text">{{ question.text }}</p>
      </div>
    </div>
    <div class="row mt-3 pt-3 border-top">
      <div class="d-flex flex-column mx-auto">
        <div class="btn-group btn-group-sm" role="group">
          <button type="button" class="btn btn-success">↑</button>
          <a class="btn border-top border-bottom between-btn">{{ question.rating }}</a>
          <button type="button" class="btn btn-danger">↓</button>
        </div>
      </div>
      <div class="col-md-10 order-2 pl-0">
        <h6 class="listhead mt-1">
          <a>Tags:</a>
          {% for tag in question.tags.all %}
          <a href="{% url 'by_tag' tag.name %}" class="badge badge-secondary secondary font-weight-light">
            {{ tag.name }}
          </a>
          {% endfor %}
        </h5>
      </div>
    </div>
  </div>

  {% for answer in answers %}
  <div class="card block">
    <div class="row">
      <div class="d-flex flex-column mx-auto">
        <img src="images/anothercat.jpg" width="80" height="80" class="rounded-circle mb-3">
        <div class="btn-group btn-group-sm" role="group">
          <button type="button" class="btn btn-success">↑</button>
          <a class="btn border-top border-bottom between-btn">{{ answer.rating }}</a>
          <button type="button" class="btn btn-danger">↓</button>
        </div>
      </div>
      <div class="col-md-10 pl-0">
        <p class="card-text">
          {{ answer.text }}
        </p>
      </div>
    </div>
    {% if answer.is_right %}
    <div class="row mt-3 pt-3 border-top">
      <div class="col-md-12 order-2">
        <div class="alert alert-success mb-0 center-text">
          <p class="text-center mb-0">
            This answer was noted by the author of the question as correct.
          </p>
        </div>
      </div>
    </div>
    {% endif %}
  </div>
  {% endfor %}

  <div class="card block myanswer">
    <h6 class="text-center">
      <a>And what do you think?</a>
    </h6>
    <div class="input-group">
      <div class="input-group-prepend">
        <button type="button" class="float-right btn btn-outline-primary">
          Answer!
        </button>
      </div>
      <textarea class="form-control" aria-label="With textarea"></textarea>
    </div>
  </div>

  <ul class="pagination">

    {% if answers.number > 2 %}
      <li class="page-item">
        <a class="page-link" href="?page=1">&laquo; first</a>
      </li>
    {% endif %}

    {% if answers.has_previous %}
      <li class="page-item">
        <a class="page-link" href="?page={{ answers.previous_page_number }}">
          {{ answers.previous_page_number }}
        </a>
      </li>
    {% endif %}
  
    {% if answers.paginator.num_pages != 1 %}
    <li class="page-item active">
      <a class="page-link" href="#">{{ answers.number }}</a>
    </li>
    {% endif %}

    {% if answers.has_next %}
      <li class="page-item">
        <a class="page-link" href="?page={{ answers.next_page_number }}">
          {{ answers.next_page_number }}
        </a>
      </li>
    {% endif %}
      
    {% if answers.next_page_number < answers.paginator.num_pages %}
      <li class="page-item">
        <a class="page-link" href="?page={{ answers.paginator.num_pages }}">
            last &raquo;
        </a>
      </li>
    {% endif %}

  </ul>

</div>

{% endblock %}